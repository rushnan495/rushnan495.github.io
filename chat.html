<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Community Chat</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body{background:linear-gradient(-45deg,#0f172a,#1e293b,#0ea5a4,#38bdf8);
background-size:400% 400%;animation:gradientMove 10s ease infinite;
color:#fff;min-height:100vh;overflow-x:hidden;padding-bottom:120px;}
@keyframes gradientMove{0%{background-position:0% 50%;}
50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
nav{position:fixed;top:0;left:0;width:100%;background:rgba(15,23,42,0.95);
display:flex;justify-content:space-between;align-items:center;
padding:14px 20px;z-index:1000;backdrop-filter:blur(6px);}
.logo{display:flex;align-items:center;font-weight:700;font-size:22px;color:#38bdf8;gap:10px;}
.logo img{width:38px;height:38px;border-radius:50%;object-fit:cover;border:2px solid #38bdf8;}
.nav-links{display:flex;gap:20px;}
.nav-links a{color:#fff;text-decoration:none;font-weight:500;padding:8px 12px;border-radius:6px;transition:0.3s;}
.nav-links a:hover{background:#38bdf8;color:#0f172a;}
.menu-btn{display:none;color:#fff;font-size:30px;background:none;border:none;cursor:pointer;}
@media(max-width:900px){.menu-btn{display:block;}
.nav-links{display:flex;flex-direction:column;position:fixed;top:60px;right:-220px;
background:rgba(15,23,42,0.95);width:200px;padding:15px;border-radius:0 0 0 8px;
text-align:right;transition:right 0.3s ease;z-index:999;}
.nav-links.active{right:0;}.nav-links a{margin-bottom:12px;}}

h1{text-align:center;color:#38bdf8;margin:80px 0 20px 0;font-size:2rem;cursor:pointer;}

/* Chat container */
.chat-wrapper{position:fixed;bottom:0;left:50%;transform:translateX(-50%);
width:400px;max-width:95%;background:rgba(0,0,0,0.1);border-radius:12px;
display:flex;flex-direction:column;box-shadow:0 0 20px rgba(0,0,0,0.3);overflow:hidden;}
.chat-messages{flex:1;max-height:320px;overflow-y:auto;padding:12px;
display:flex;flex-direction:column;gap:8px;background:rgba(255,255,255,0.05);}
.message-card{display:flex;gap:10px;align-items:flex-start;position:relative;}
.message-card img{width:42px;height:42px;border-radius:50%;object-fit:cover;}
.meta{display:flex;flex-direction:column;max-width:75%;}
.meta h3{margin:0;color:#38bdf8;font-size:14px;display:flex;align-items:center;gap:5px;}
.meta small{color:#cbd5e1;font-size:11px;}
.meta p{margin:4px 0 0 0;font-size:14px;color:#e6eef5;white-space:pre-wrap;}
.reply-box{background:rgba(56,189,248,0.1);border-left:3px solid #38bdf8;
padding:4px 8px;margin-bottom:4px;border-radius:4px;font-size:12px;color:#a0aec0;}
.options-btn{position:absolute;right:-22px;top:5px;color:#38bdf8;font-size:18px;
cursor:pointer;display:none;}
.message-card:hover .options-btn{display:block;}
.reaction-menu{position:absolute;right:20px;top:-30px;background:rgba(15,23,42,0.9);
padding:6px 8px;border-radius:12px;display:flex;gap:6px;display:none;}
.reaction-menu span{cursor:pointer;font-size:18px;}
.show-menu{display:flex!important;}
.reaction-display{font-size:16px;margin-top:4px;}

/* Send area */
.send-area{display:flex;gap:8px;padding:12px;background:rgba(255,255,255,0.1);
border-top:1px solid #38bdf8;border-radius:0 0 12px 12px;}
.send-area textarea{flex:1;padding:12px;border-radius:8px;border:none;
background:rgba(255,255,255,0.1);color:#fff;font-size:16px;resize:none;outline:none;}
.send-area button{background:#38bdf8;color:#0f172a;border:none;
padding:12px 14px;border-radius:50%;font-weight:bold;cursor:pointer;transition:0.3s;}
.send-area button:hover{background:#0ea5a4;transform:scale(1.05);}
.file-icon{cursor:pointer;font-size:20px;color:#38bdf8;display:flex;align-items:center;justify-content:center;}
.send-area input[type=file]{display:none;}

/* Admin Panel */
.admin-panel{position:fixed;top:60px;right:20px;background:rgba(0,0,0,0.2);
padding:15px;border-radius:10px;display:none;flex-direction:column;gap:10px;z-index:999;}
.admin-panel.open{display:flex;}
.admin-panel input, .admin-panel button{margin:6px 0;padding:10px;border:none;
border-radius:8px;font-size:15px;}
.admin-panel input{background:rgba(255,255,255,0.1);color:#fff;}
.admin-panel button{background:#38bdf8;color:#0f172a;font-weight:bold;cursor:pointer;}
.admin-panel button:hover{background:#0ea5a4;transform:scale(1.03);}
</style>
</head>
<body>
<nav>
<div class="logo"><img src="edu-sports-it.png" alt="Logo"><span>EDU SPORTS IT</span></div>
<button class="menu-btn" id="menuBtn">&#9776;</button>
<div class="nav-links" id="navLinks">
<a href="/">Home</a><a href="/courses">Courses</a>
<a href="/chat">World Chat</a><a href="/help">Help Center</a>
<a href="/review">Reviews</a><a href="/login">Login</a>
<a href="/signup">Sign-Up</a><a href="/profile">Profile</a>
</div>
</nav>

<h1 id="chatHeading">Community Chat & News</h1>

<div class="chat-wrapper">
  <div class="chat-messages" id="chatMessages"></div>
  <div class="send-area">
    <label for="chatMedia" class="file-icon">&#128247;</label>
    <input type="file" id="chatMedia" accept="image/*">
    <textarea id="chatInput" placeholder="Type a message..."></textarea>
    <button onclick="sendMessage()">&#10148;</button>
  </div>
</div>

<div class="admin-panel" id="adminPanel">
  <div id="adminLogin">
    <h3>Admin Login</h3>
    <input type="email" id="adminEmail" placeholder="Admin Email">
    <input type="password" id="adminPass" placeholder="Password">
    <button onclick="adminLogin()">Login</button>
  </div>
  <div id="adminControls" style="display:none;">
    <h3>Admin Controls</h3>
    <input type="email" id="banEmail" placeholder="Enter email to ban/unban">
    <button onclick="banUser()">Ban/Unban User</button>
    <button onclick="deleteAll()">Delete All Messages</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script>
const firebaseConfig={apiKey:"AIzaSyDR5yywOyYjCSnfTyLTcMUIz-hG80jZXU4",
authDomain:"edu-sports-it.firebaseapp.com",
databaseURL:"https://edu-sports-it-default-rtdb.firebaseio.com/",
projectId:"edu-sports-it",storageBucket:"edu-sports-it.appspot.com"};
firebase.initializeApp(firebaseConfig);
const db=firebase.database(),auth=firebase.auth();

const verifiedUsers={
  "rushnankhan02@gmail.com":{name:"Rushnan Khan — ADMIN",photo:"rushnan.jpg"},
  "contact@mubarrat.com":{name:"Mubarrat — VERIFIED",photo:"mubarrat.jpg"},
  "msaadman56@proton.me":{name:"Saadman — VERIFIED",photo:"saadu.jpg"}
};
const adminEmails=["rushnankhan02@gmail.com"];
let isAdmin=false,bannedUsers={};

document.getElementById("chatHeading").addEventListener("click",()=>{
 document.getElementById("adminPanel").classList.toggle("open");
});
document.getElementById("menuBtn").onclick=()=>document.getElementById("navLinks").classList.toggle("active");

function adminLogin(){
  const email=document.getElementById("adminEmail").value,
  pass=document.getElementById("adminPass").value;
  if(!adminEmails.includes(email)){alert("You are not allowed!");return;}
  auth.signInWithEmailAndPassword(email,pass).then(()=>{
    isAdmin=true;
    document.getElementById("adminLogin").style.display="none";
    document.getElementById("adminControls").style.display="block";
    loadMessages();
  }).catch(e=>alert(e.message));
}

function banUser(){
 const email=document.getElementById("banEmail").value.trim();
 if(!email)return alert("Enter email!");
 db.ref("banned/"+btoa(email)).once("value").then(snap=>{
  if(snap.exists()){db.ref("banned/"+btoa(email)).remove();alert(email+" unbanned");}
  else{db.ref("banned/"+btoa(email)).set(true);alert(email+" banned");}
 });
}

function sendMessage(){
 const user=auth.currentUser;
 if(!user){alert("Login first!");return;}
 if(bannedUsers[user.email]){alert("You are banned!");return;}
 const txt=document.getElementById("chatInput").value.trim();
 if(!txt)return;
 const data={name:user.email, text:txt, time:new Date().toLocaleString(),
 uid:user.uid, email:user.email};
 db.ref("chat").push(data);
 document.getElementById("chatInput").value="";
}

function loadMessages(){
 db.ref("banned").on("value",snap=>{bannedUsers={};snap.forEach(e=>bannedUsers[atob(e.key)]=true);});
 const box=document.getElementById("chatMessages");
 db.ref("chat").on("value",snap=>{
  box.innerHTML="";
  snap.forEach(c=>{
   const d=c.val();
   const div=document.createElement("div");
   div.className="message-card";
   div.innerHTML=`
    <img src="${verifiedUsers[d.email]?.photo||'https://cdn-icons-png.flaticon.com/512/3135/3135715.png'}">
    <div class="meta">
      <h3>${verifiedUsers[d.email]?.name||d.name}</h3>
      <small>${d.time}</small>
      <p>${d.text}</p>
      ${isAdmin||auth.currentUser?.email===d.email?`<button class='delete-btn' onclick="deleteMessage('${c.key}')">X</button>`:""}
    </div>`;
   box.appendChild(div);
  });
 });
}

function deleteMessage(id){db.ref("chat/"+id).remove();}
function deleteAll(){if(confirm("Delete all?"))db.ref("chat").remove();}
</script>
</body>
</html>
