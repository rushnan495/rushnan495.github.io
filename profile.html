<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EDU SPORTS IT — Profile</title>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body{
  background: linear-gradient(-45deg, #0f172a, #1e293b, #0ea5a4, #38bdf8);
  background-size: 400% 400%;
  animation: gradientMove 10s ease infinite;
  color: #fff;
  overflow-x:hidden;
}
@keyframes gradientMove {0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
nav{
  position:fixed;top:0;left:0;width:100%;background:rgba(15,23,42,0.95);
  display:flex;justify-content:space-between;align-items:center;padding:14px 20px;z-index:1000;
  backdrop-filter: blur(6px);
}
nav .logo{font-weight:700;font-size:22px;color:#38bdf8;display:flex;align-items:center;gap:10px;}
nav .logo img{width:38px;height:38px;border-radius:50%;object-fit:cover;border:2px solid #38bdf8;}
nav .nav-links{display:flex;gap:20px;}
nav .nav-links a{color:#fff;text-decoration:none;font-weight:500;padding:8px 12px;border-radius:6px;transition:0.3s;}
nav .nav-links a:hover{background:#38bdf8;color:#0f172a;}
.menu-btn{display:none;color:#fff;font-size:30px;background:none;border:none;cursor:pointer;}
@media (max-width:900px){
  .menu-btn{display:block;}
  .nav-links{display:none;flex-direction:column;position:absolute;top:60px;right:20px;background:rgba(15,23,42,0.98);
  width:200px;border-radius:8px;padding:15px;text-align:right;}
  .nav-links.active{display:flex;animation:slide 0.3s ease;}
  @keyframes slide{from{opacity:0;transform:translateY(-10px);}to{opacity:1;transform:translateY(0);} }
}

.profile-container{
  display:flex;justify-content:center;align-items:center;
  padding-top:80px;padding-bottom:50px;
}
.profile-box{
  background: rgba(0,0,0,0.6);
  padding:40px;border-radius:12px;width:400px;text-align:center;
  box-shadow:0 8px 20px rgba(0,0,0,0.3);
  position:relative;
}
.profile-pic-wrapper{position:relative;width:120px;margin:0 auto 15px auto;}
#profilePic{width:120px;height:120px;border-radius:50%;object-fit:cover;border:2px solid #38bdf8;cursor:pointer;}
#uploadIcon{position:absolute;bottom:0;right:0;background:#38bdf8;color:#0f172a;border-radius:50%;padding:6px;font-size:18px;cursor:pointer;border:2px solid #0f172a;}
.profile-box input{width:100%;margin:10px 0;padding:10px;border:none;border-radius:6px;font-size:16px;outline:none;}
.save-btn{margin-top:15px;padding:10px 20px;border:none;border-radius:6px;background:#38bdf8;color:#0f172a;font-weight:600;cursor:pointer;transition:0.3s;}
.save-btn:hover{background:#0ea5a4;}
.logout-btn{margin-top:10px;padding:10px 20px;border:none;border-radius:6px;background:orange;color:#0f172a;font-weight:600;cursor:pointer;transition:0.3s;}
.logout-btn:hover{background:#ff9500;}

.courses-section{text-align:center;margin-top:40px;padding:40px 20px; display:none;}
.courses-section h2{font-size:26px;color:#38bdf8;margin-bottom:15px;}
#emptyMsg{color:#94a3b8;margin-top:10px;}
.course-grid{display:flex;flex-wrap:wrap;justify-content:center;gap:25px;margin-top:25px;}
.course-card{
  background:rgba(15,23,42,0.9);
  border-radius:10px;width:220px;padding:15px;
  box-shadow:0 0 15px rgba(56,189,248,0.3);
  transition:0.3s;cursor:pointer;
}
.course-card:hover{transform:translateY(-6px);box-shadow:0 0 25px rgba(56,189,248,0.6);}
.course-card img{width:100%;border-radius:8px;margin-bottom:10px;}
.course-card h3{color:#38bdf8;margin-bottom:6px;}
.delete-btn{margin-top:20px;background:#ef4444;color:#fff;border:none;padding:10px 20px;border-radius:8px;font-weight:600;cursor:pointer;transition:0.3s; display:none;}
.delete-btn:hover{background:#ff4d4d;}

footer{text-align:center;padding:25px;color:#94a3b8;margin-top:50px;}
</style>
</head>
<body>

<nav>
  <div class="logo">
    <img src="edu-sports-it.png" alt="Logo">
    <span>EDU SPORTS IT</span>
  </div>
  <button class="menu-btn" id="menuBtn">&#9776;</button>
  <div class="nav-links" id="navLinks">
    <a href="index.html">Home</a>
    <a href="courses.html">Courses</a>
    <a href="about.html">About</a>
    <a href="event.html">Events</a>
    <a href="help.html">Help Center</a>
    <a href="review.html">Reviews</a>
    <a href="login.html">Login</a>
    <a href="signup.html">Sign-Up</a>
    <a href="profile.html">Profile</a>
  </div>
</nav>

<div class="profile-container">
  <div class="profile-box">
    <div class="profile-pic-wrapper">
      <img id="profilePic" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAdHx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIALQAvwMBIgACEQEDEQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAABAUCAwYBB//EADYQAQACAQIFAgIHBgcAAAAAAAABAgMEEQUSMUFRISJSYRNxgZGhscEyNEJi8PEVIyQzcpLR/8QAFgEBAQEAAAAAAAAAAAAAAAAAAAEC/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oADAMBAAIRAxEAPwD6WA0yAAAAAAAABETM7RG8+Ib6aLU36YpiPn6A0CX/AIbqdulf+zTm0+bB/uUmI89YFagBAAAAAAAAAAAAAAAABYaThs3iL596x2rHU4XpYvb6a8e2s+2PMrZLVYYsOPDG2OkV+pmCKPLVi9ZraImJ6xL0BR6vRZMWa0Y6XtTrExG+yL0naXTI+r0lNTXpEXjpZdTFCPb1tS81tG1onaYeKgAAAAAAAAAAAAREzO0dRu0VebV4o/m3+4F5gxxhw0xx/DDYDLQAAAAACp4xjiuWmSP4o2n7Fet+MR/p6T4v+kqhqIACAAAAAAAAAACTw399x/b+UozfoJ5dZin57Cr8BlQAAAAAEHjH7rX/AJx+UqdbcZn/ACccebb/AIKlqJQAQAAAAAAAAAAT+F6amWZy339kxy+vdAWnBbe3LXxMSVVkAyoAAAAACPrNNXU49rb81YnlmPKhdJeeWlrT2jdzaxKAKgAAAAAAAAAAlcOzRh1Mc07VtHLM+EUB0wg8JyTfTzSZ3mk/gnMtAAAAAPJmIjeekAicTzxi09qb++8bRHy7qVllvOTJa9pmZtO/qxaQAEAAAAAAAAAAAATOFZox6jltPpeNvt7LpzK64dq51FJpf9uses+UqxMARQABG4jmjFpbevut7YSJnaN1Dq9TbU5eafSsfsx4WDQArIAAAAAAAAAAAAAAseCx78s+Ij9VctuDV2w5Lebbfd/cqrABlQABzMxtMx4dM53U15NRlr4tKxK1gKgAAAAAAAAAAAAPaVte0VpWbTPaIWGn4Xafdnty/wAteoqFgw3z3imON57z2hfYMVcGKuOvSO/l7jx0xV5cdYrHyZpaoAgAAK7iektefpsUbzt7ojv81iA5kXmp0OLPvbbkv8Ufqq9To82DeZjmp8VWtRHAEAAAAAAAStJosmo2tPtx/FPf6hUWsTaYrWJmZ6RCw0/DL292eeSPhjqsNPpsWnjbHX172nrLcmmNeHDjw12x0iv6tgIoAAAAAAAAACJqOH4c281j6O3mOn3KvUaTLp/W9d6/FHRfnVdHMi31XDaZN7YdqW8dp/8AFVkx3xXmmSs1tHaVRiAIAyx0nJkrSOtp2BM4bo4zT9Llj2RPpHxLjoxx0jHStKxtFY2hky0AAAAAAAAAAAAAAAANOp09NRj5bx69rd4bgHN5cdsOS2O8esMVrxjDvSuaI9Y9J+r+vzVTSCVwyInWU37bz+DwBegMqAAAAAAAAAAAAAAAAAAj6+InR5d/h3UILEr/2Q==" alt="Profile Picture">
      <label id="uploadIcon" title="Upload Photo">&#9998;
        <input type="file" id="photoInput" accept="image/*" style="display:none;">
      </label>
    </div>
    <input type="text" id="name" placeholder="Name">
    <input type="text" id="institution" placeholder="Institution">
    <input type="text" id="class" placeholder="Class">
    <input type="text" id="roll" placeholder="Roll">
    <input type="text" id="version" placeholder="Version">
    <input type="text" id="branch" placeholder="Branch">
    <button class="save-btn" onclick="saveProfile()">Save Profile</button>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>
</div>

<section class="courses-section" id="graphicsCourseSection">
  <h2>Your Graphics & Web Design Course</h2>
  <p id="emptyMsg">Empty — You haven’t unlocked this course yet.</p>
  <div class="course-grid" id="courseGrid"></div>
  <button class="delete-btn" id="deleteSubBtn">Delete Subscription</button>
</section>

<footer>© 2025 EDU SPORTS INFORMATION & TECHNOLOGY</footer>

<script>
const menuBtn=document.getElementById('menuBtn');
const navLinks=document.getElementById('navLinks');
menuBtn.addEventListener('click',()=>navLinks.classList.toggle('active'));

const firebaseConfig={
  apiKey:"AIzaSyDR5yywOyYjCSnfTyLTcMUIz-hG80jZXU4",
  authDomain:"edu-sports-it.firebaseapp.com",
  databaseURL:"https://edu-sports-it-default-rtdb.firebaseio.com",
  projectId:"edu-sports-it",
  storageBucket:"edu-sports-it.appspot.com"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.database();
const storage=firebase.storage();

let selectedFile=null;
const courseSection=document.getElementById('graphicsCourseSection');
const courseGrid=document.getElementById('courseGrid');
const emptyMsg=document.getElementById('emptyMsg');
const deleteBtn=document.getElementById('deleteSubBtn');

// --- Load profile & courses ---
auth.onAuthStateChanged(async user=>{
  if(user){
    const uid=user.uid;
    const snapshot=await db.ref("users/"+uid).get();
    if(snapshot.exists()){
      const data=snapshot.val();
      document.getElementById('name').value=data.name||"";
      document.getElementById('institution').value=data.institution||"";
      document.getElementById('class').value=data.class||"";
      document.getElementById('roll').value=data.roll||"";
      document.getElementById('version').value=data.version||"";
      document.getElementById('branch').value=data.branch||"";
      if(data.photoURL) document.getElementById('profilePic').src=data.photoURL;
    }

    // --- Show graphics course only if unlocked ---
    const unlocked = localStorage.getItem("graphics_course_unlocked");
    if(unlocked==="true"){
      courseSection.style.display="block";
      deleteBtn.style.display="inline-block";
      courseGrid.innerHTML="";
      const div=document.createElement("div");
      div.className="course-card";
      div.innerHTML=`<img src="graphics-thumb.jpg" alt=""><h3>Graphics Design</h3><p>Click to open</p>`;
      div.onclick=()=>location.href="graphics-page.html";
      courseGrid.appendChild(div);
      emptyMsg.style.display="none";
    } else {
      courseSection.style.display="block";
      deleteBtn.style.display="none";
      emptyMsg.style.display="block";
    }
  } else{
    alert("Please login first!");
    window.location.href="login.html";
  }
});

// --- Image upload ---
const photoInput=document.getElementById('photoInput');
photoInput.addEventListener('change',function(){
  const file=this.files[0];
  if(file){
    selectedFile=file;
    const reader=new FileReader();
    reader.onload=e=>document.getElementById('profilePic').src=e.target.result;
    reader.readAsDataURL(file);
  }
});
document.getElementById('profilePic').addEventListener('click',()=>photoInput.click());
document.getElementById('uploadIcon').addEventListener('click',()=>photoInput.click());

// --- Save profile ---
async function saveProfile(){
  const user=auth.currentUser;
  if(!user) return alert("Please login first!");
  const uid=user.uid;
  let photoURL=null;
  if(selectedFile){
    const storageRef=storage.ref('profilePics/'+uid+'/'+selectedFile.name);
    const snap=await storageRef.put(selectedFile);
    photoURL=await snap.ref.getDownloadURL();
  }
  const data={
    name:document.getElementById('name').value,
    institution:document.getElementById('institution').value,
    class:document.getElementById('class').value,
    roll:document.getElementById('roll').value,
    version:document.getElementById('version').value,
    branch:document.getElementById('branch').value
  };
  if(photoURL) data.photoURL=photoURL;
  await db.ref('users/'+uid).update(data);
  alert("Profile saved successfully!");
  selectedFile=null;
}

// --- Logout ---
function logout(){auth.signOut().then(()=>location.href="index.html");}

// --- Delete Subscription ---
deleteBtn.addEventListener('click',()=>{
  if(confirm("Are you sure you want to delete subscription?")){
    localStorage.removeItem("graphics_course_unlocked");
    location.reload();
  }
});
</script>
</body>
</html>

